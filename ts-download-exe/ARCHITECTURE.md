# é¡¹ç›®æ¶æ„æ–‡æ¡£

## æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TS-Merge åº”ç”¨                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           React å‰ç«¯ (TypeScript)                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  App.tsx (ä¸»åº”ç”¨ç»„ä»¶ï¼ŒTab ç®¡ç†)               â”‚  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚   â”‚
â”‚  â”‚  â”‚  pages/FileMerge.tsx (æ–‡ä»¶åˆå¹¶é¡µé¢)           â”‚  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚   â”‚
â”‚  â”‚  â”‚  components/                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ TabBar.tsx (å¯¼èˆªæ )                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ FileList.tsx (æ–‡ä»¶åˆ—è¡¨)                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ MergeOptions.tsx (åˆå¹¶é€‰é¡¹)               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ ProgressBar.tsx (è¿›åº¦æ¡)                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†•                                   â”‚
â”‚                   Wails Bridge (IPC)                         â”‚
â”‚                          â†•                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           Go åç«¯ (ä¸šåŠ¡é€»è¾‘)                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  app.go                                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ MergeExcelFiles() (åˆå¹¶é€»è¾‘)              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ removeDuplicates() (å»é‡é€»è¾‘)             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ GetExcelFiles() (è·å–æ–‡ä»¶)                â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†•                                   â”‚
â”‚              excelize åº“ (Excel å¤„ç†)                        â”‚
â”‚                          â†•                                   â”‚
â”‚                    æ–‡ä»¶ç³»ç»Ÿ I/O                              â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ¨¡å—è¯´æ˜

### å‰ç«¯æ¨¡å—

#### 1. App.tsx (ä¸»åº”ç”¨)
- **èŒè´£**: ç®¡ç†åº”ç”¨çŠ¶æ€å’Œ Tab åˆ‡æ¢
- **å…³é”®å±æ€§**:
  - `activeTab` - å½“å‰æ´»è·ƒçš„ Tab
  - `TabType` - Tab ç±»å‹æšä¸¾
- **å…³é”®æ–¹æ³•**:
  - `renderContent()` - æ ¹æ® Tab ç±»å‹æ¸²æŸ“å¯¹åº”é¡µé¢

#### 2. pages/FileMerge.tsx (æ–‡ä»¶åˆå¹¶é¡µé¢)
- **èŒè´£**: æ–‡ä»¶åˆå¹¶åŠŸèƒ½çš„ä¸»é¡µé¢
- **å…³é”®çŠ¶æ€**:
  - `files` - å·²é€‰æ‹©çš„æ–‡ä»¶åˆ—è¡¨
  - `isDragging` - æ˜¯å¦æ­£åœ¨æ‹–æ‹½
  - `progress` - å¤„ç†è¿›åº¦ (0-100)
  - `isProcessing` - æ˜¯å¦æ­£åœ¨å¤„ç†
  - `logs` - å¤„ç†æ—¥å¿—
- **å…³é”®æ–¹æ³•**:
  - `handleDrop()` - å¤„ç†æ–‡ä»¶æ‹–æ‹½
  - `handleStartMerge()` - å¼€å§‹åˆå¹¶
  - `addLog()` - æ·»åŠ æ—¥å¿—

#### 3. components/TabBar.tsx (å¯¼èˆªæ )
- **èŒè´£**: æ˜¾ç¤º Tab å¯¼èˆªæ 
- **Props**:
  - `activeTab` - å½“å‰æ´»è·ƒ Tab
  - `onTabChange` - Tab åˆ‡æ¢å›è°ƒ
- **Tab åˆ—è¡¨**:
  - æ–‡ä»¶åˆå¹¶ (file-merge)
  - æ–‡ä»¶æ‹†åˆ† (file-split)
  - æ–‡ä»¶è¿‡æ»¤ (file-filter)
  - æ–‡ä»¶é‡å¤ (file-duplicate)
  - å·ç æ‹†åˆ† (code-split)

#### 4. components/FileList.tsx (æ–‡ä»¶åˆ—è¡¨)
- **èŒè´£**: æ˜¾ç¤ºå·²é€‰æ‹©çš„æ–‡ä»¶åˆ—è¡¨
- **Props**:
  - `files` - æ–‡ä»¶åˆ—è¡¨
  - `onRemoveFile` - ç§»é™¤æ–‡ä»¶å›è°ƒ
  - `onClearFiles` - æ¸…ç©ºåˆ—è¡¨å›è°ƒ

#### 5. components/MergeOptions.tsx (åˆå¹¶é€‰é¡¹)
- **èŒè´£**: é…ç½®åˆå¹¶é€‰é¡¹
- **åŠŸèƒ½**:
  - å»é‡é€‰é¡¹åˆ‡æ¢
  - å»é‡åˆ—åè¾“å…¥
  - è¾“å‡ºæ–‡ä»¶è·¯å¾„è®¾ç½®
  - å¼€å§‹åˆå¹¶æŒ‰é’®

#### 6. components/ProgressBar.tsx (è¿›åº¦æ¡)
- **èŒè´£**: æ˜¾ç¤ºå¤„ç†è¿›åº¦
- **Props**:
  - `progress` - è¿›åº¦ç™¾åˆ†æ¯” (0-100)

### åç«¯æ¨¡å—

#### 1. main.go (åº”ç”¨å…¥å£)
- **èŒè´£**: Wails åº”ç”¨åˆå§‹åŒ–
- **å…³é”®é…ç½®**:
  - çª—å£å¤§å°: 1200x800
  - æœ€å°çª—å£å¤§å°: 900x600
  - èµ„æºåµŒå…¥
  - å‰ç«¯èµ„æºè·¯å¾„

#### 2. app.go (ä¸šåŠ¡é€»è¾‘)

##### MergeExcelFiles() æ–¹æ³•
```go
func (a *App) MergeExcelFiles(filePaths []string, config MergeConfig) MergeResult
```
- **è¾“å…¥**:
  - `filePaths` - Excel æ–‡ä»¶è·¯å¾„æ•°ç»„
  - `config` - åˆå¹¶é…ç½® (å»é‡é€‰é¡¹ã€è¾“å‡ºè·¯å¾„)
- **å¤„ç†æµç¨‹**:
  1. éªŒè¯è¾“å…¥æ–‡ä»¶
  2. é€ä¸ªè¯»å– Excel æ–‡ä»¶
  3. æå–è¡¨å¤´å’Œæ•°æ®
  4. åˆå¹¶æ‰€æœ‰æ•°æ®
  5. æ‰§è¡Œå»é‡å¤„ç† (å¦‚æœå¯ç”¨)
  6. ç”Ÿæˆæ–° Excel æ–‡ä»¶
  7. è¿”å›å¤„ç†ç»“æœ
- **è¾“å‡º**:
  - `MergeResult` - åŒ…å«æˆåŠŸçŠ¶æ€ã€æ¶ˆæ¯ã€è¾“å‡ºè·¯å¾„ã€è¡Œæ•°ç»Ÿè®¡

##### removeDuplicates() æ–¹æ³•
```go
func removeDuplicates(rows []map[string]interface{}, column string) []map[string]interface{}
```
- **åŠŸèƒ½**: æŒ‰æŒ‡å®šåˆ—å»é™¤é‡å¤è¡Œ
- **ç®—æ³•**: ä½¿ç”¨ map è®°å½•å·²è§çš„å€¼ï¼Œä¿ç•™ç¬¬ä¸€æ¬¡å‡ºç°çš„è¡Œ

##### GetExcelFiles() æ–¹æ³•
```go
func (a *App) GetExcelFiles(folderPath string) ([]string, error)
```
- **åŠŸèƒ½**: è·å–æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰ Excel æ–‡ä»¶
- **è¿”å›**: Excel æ–‡ä»¶è·¯å¾„åˆ—è¡¨

## æ•°æ®æµ

### æ–‡ä»¶åˆå¹¶æµç¨‹

```
ç”¨æˆ·æ“ä½œ
   â†“
[æ‹–æ‹½/é€‰æ‹©æ–‡ä»¶] â†’ FileList æ›´æ–°
   â†“
[é…ç½®é€‰é¡¹] â†’ MergeOptions çŠ¶æ€æ›´æ–°
   â†“
[ç‚¹å‡»å¼€å§‹åˆå¹¶]
   â†“
FileMerge.handleStartMerge()
   â†“
è°ƒç”¨ Go åç«¯: MergeExcelFiles()
   â†“
Go åç«¯å¤„ç†:
  1. è¯»å–æ‰€æœ‰ Excel æ–‡ä»¶
  2. åˆå¹¶æ•°æ®
  3. å»é‡å¤„ç†
  4. ç”Ÿæˆè¾“å‡ºæ–‡ä»¶
   â†“
è¿”å› MergeResult
   â†“
æ›´æ–° UI:
  - è¿›åº¦æ¡
  - æ—¥å¿—ä¿¡æ¯
  - å¤„ç†çŠ¶æ€
   â†“
æ˜¾ç¤ºå®Œæˆä¿¡æ¯
```

## ç±»å‹å®šä¹‰

### å‰ç«¯ç±»å‹

```typescript
// æ–‡ä»¶é¡¹
interface FileItem {
  id: string;
  name: string;
  path: string;
}

// åˆå¹¶é…ç½®
interface MergeConfig {
  removeDuplicates: boolean;
  deduplicateColumn: string;
  outputPath: string;
}

// Tab ç±»å‹
type TabType = 'file-merge' | 'file-split' | 'file-filter' | 'file-duplicate' | 'code-split';
```

### åç«¯ç±»å‹

```go
// åˆå¹¶é…ç½®
type MergeConfig struct {
  RemoveDuplicates  bool   `json:"removeDuplicates"`
  DeduplicateColumn string `json:"deduplicateColumn"`
  OutputPath        string `json:"outputPath"`
}

// åˆå¹¶ç»“æœ
type MergeResult struct {
  Success         bool   `json:"success"`
  Message         string `json:"message"`
  OutputPath      string `json:"outputPath"`
  RowsProcessed   int    `json:"rowsProcessed"`
  RowsAfterDedupe int    `json:"rowsAfterDedupe"`
}
```

## æ ·å¼æ¶æ„

- **å…¨å±€æ ·å¼**: `frontend/src/index.css`
- **ç»„ä»¶æ ·å¼**: æ¯ä¸ªç»„ä»¶å¯¹åº”ä¸€ä¸ª `.css` æ–‡ä»¶
- **é¢œè‰²æ–¹æ¡ˆ**:
  - ä¸»è‰²: `#667eea` (ç´«è“)
  - å‰¯è‰²: `#764ba2` (æ·±ç´«)
  - æˆåŠŸ: `#51cf66` (ç»¿)
  - é”™è¯¯: `#ff6b6b` (çº¢)
  - èƒŒæ™¯: `#f5f5f5` (æµ…ç°)

## æ‰©å±•æ€§è®¾è®¡

### æ·»åŠ æ–°çš„ Tab åŠŸèƒ½

1. **æ›´æ–° TabType**:
   ```typescript
   type TabType = '...' | 'new-feature';
   ```

2. **åˆ›å»ºæ–°é¡µé¢**:
   ```typescript
   // frontend/src/pages/NewFeature.tsx
   const NewFeature: React.FC = () => { ... };
   ```

3. **åœ¨ App.tsx ä¸­æ·»åŠ è·¯ç”±**:
   ```typescript
   case 'new-feature':
     return <NewFeature />;
   ```

4. **åœ¨ TabBar ä¸­æ·»åŠ  Tab**:
   ```typescript
   { id: 'new-feature', label: 'æ–°åŠŸèƒ½', icon: 'ğŸ¯' }
   ```

### æ·»åŠ æ–°çš„åç«¯åŠŸèƒ½

1. **åœ¨ app.go ä¸­æ·»åŠ æ–¹æ³•**:
   ```go
   func (a *App) NewFunction(params Type) ResultType {
     // å®ç°é€»è¾‘
   }
   ```

2. **åœ¨å‰ç«¯è°ƒç”¨**:
   ```typescript
   import { NewFunction } from '../../wailsjs/go/main/App';
   const result = await NewFunction(params);
   ```

## æ€§èƒ½è€ƒè™‘

- **å¤§æ–‡ä»¶å¤„ç†**: Go çš„å¹¶å‘èƒ½åŠ›å¤„ç†å¤§ Excel æ–‡ä»¶
- **UI å“åº”**: ä½¿ç”¨å¼‚æ­¥å¤„ç†ï¼Œä¸é˜»å¡ UI
- **å†…å­˜ç®¡ç†**: åŠæ—¶é‡Šæ”¾èµ„æºï¼Œé¿å…å†…å­˜æ³„æ¼
- **è¿›åº¦åé¦ˆ**: å®æ—¶æ›´æ–°è¿›åº¦æ¡ï¼Œæå‡ç”¨æˆ·ä½“éªŒ

## å®‰å…¨æ€§è€ƒè™‘

- **æ–‡ä»¶éªŒè¯**: æ£€æŸ¥æ–‡ä»¶ç±»å‹å’Œè·¯å¾„
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯æ•è·å’Œæç¤º
- **æ•°æ®éš”ç¦»**: å‰åç«¯é€šè¿‡ IPC é€šä¿¡ï¼Œæ•°æ®éš”ç¦»
